---
layout: article
title: 再帰処理を使って重複しない組み合わせ(nPr)を求める
tags: JavaScript
aside:
  toc: true
---

## この記事について

以下の説明をしています。

- そもそも順列(nPr)とは
- 再帰処理とは
- 順列を出力するサンプルプログラムの紹介

# 順列とは

そもそも順列ってなんだっけ？
まずは算数をおさらいします。

###

「異なる n 個のものから、r 個を取り出して並べる」ときの並び順の数です。

![image](https://user-images.githubusercontent.com/44778704/87756385-ce6f8300-c843-11ea-8315-1d6f5ba5e241.png)

## nCr との違いに注意

注意しなければならないのは、`「1:ねずみ」「2:うし」`と`「1:うし」「2:ねずみ」`は異なる組み合わせだという点です。

これを「同じ組み合わせ」とみなす考え方は `nCr`です。
この 2 つはよく混同されますが**別物**なので、どちらのパターンが必要なのか見極めてください。

![image](https://user-images.githubusercontent.com/44778704/87757215-3d011080-c845-11ea-8f8a-fbdd8010266b.png)

## 順列の求め方

以下の公式に当てはめて求めることが可能です。
![image](https://user-images.githubusercontent.com/44778704/87760299-7ee08580-c84a-11ea-8ec0-2cd1dd465e51.png)

これを数字`3P2` に置き換えると以下のようになります。
![image](https://user-images.githubusercontent.com/44778704/87760536-d979e180-c84a-11ea-805a-99740619e3d5.png)

`!`記号は階乗と呼ばれる数です。
直前の数から 1 までを掛け合わせるという意味を持ちます。
例えば`5!`は`5*4*3*2*1`と同じです。
これを先ほどの式に当てはめると以下のようになります。
![image](https://user-images.githubusercontent.com/44778704/87761796-0b8c4300-c84d-11ea-93c1-6bd1a4b70c5a.png)

3P2 の答えは「6」 になりました

もう少し理解を深めるため、別の数も計算してみます。

### 4P2

4P2 を数式に当てはめると以下のようになります。
![image](https://user-images.githubusercontent.com/44778704/87762649-6f633b80-c84e-11ea-9c34-8b54f1705ab5.png)

さらに階乗を分解すると以下のようになります。
![image](https://user-images.githubusercontent.com/44778704/87762871-c0732f80-c84e-11ea-953e-22c5ecc1a347.png)

4P2 の答えは「12」になりました

### プログラムサンプル

紹介した順列の数式をもとにコードを書いてみます。

```js
const permutation = (n, r) => {
  const result = [];

  // 文字数チェック
  if (n.length < r) return [];

  // r が 1 なら
  if (r === 1) {
    for (let i = 0; i < n.length; i++) {
      result[i] = [n[i]];
    }
    return result;
  }
  for (let i = 0; i < n.length; i++) {
    const parts = n.slice(0);
    parts.splice(i, 1)[0];
    let row = permutation(parts, r - 1);
    for (let j = 0; j < row.length; j++) {
      result.push([n[i]].concat(row[j]));
      console.log([n[i]].concat(row[j]));
    }
  }

  return result;
};

let arr = permutation([""], 1);
console.log(JSON.stringify(arr));
// [["a","b"],["a","c"],["b","a"],["b","c"],["c","a"],["c","b"]]
```

# 参考

[５分で分かる！確率統計「nCr」の計算方法](https://blog.apar.jp/data-analysis/3927/)

[順列・組み合わせ のサンプルコード JS [permutation] [combination]](https://tech-blog.s-yoshiki.com/entry/144#%E9%A0%86%E5%88%97---permutation)
